# 今日の課題（Python）: Windowsタスクバーで「状態が見える」常駐ツール

## ゴール
Pythonで **Windowsのタスクバー（通知領域＝トレイ）** に常駐する小さなツールを作り、  
「今の状態（ON/OFFなど）」を **タスクバーから一発で確認＆切り替え** できるようにしてください。

> いわゆる「常駐アプリ」「トレイアイコン」の最小構成を作る課題です。

---

## 仕様（必須）
1. アプリ起動後、**通知領域（タスクトレイ）にアイコン**が出ること  
2. 右クリックでメニューを表示し、以下を持つこと  
   - `Toggle` : 内部状態（ON/OFF）を切り替える  
   - `Show status` : 現在状態をトースト/バルーン通知（またはメッセージ）で表示  
   - `Exit` : 終了  
3. 状態が切り替わったら、**アイコンやツールチップ、通知文**のどれかが変化して「切り替わった感」が出ること  
4. **状態はファイルに保存**して、再起動後も復元されること（例: `state.json`）

---

## 追加条件（できたら）
- ダブルクリックで `Show status`
- 1分ごとに「状態に応じた通知」を出す（うるさいのでONのときだけ、など工夫してOK）
- ログを `app.log` に追記（起動/終了/トグル時）

---

## 制約
- 実行は Windows11 / VSCode 前提
- UIは「トレイだけ」でOK（ウィンドウ無しで成立させる）
- できるだけコードは分割して、責務を分ける（例: `state.py`, `tray.py`, `main.py`）

---

## ヒント（重要：タスクバー周りのやり方）
Python標準ライブラリだけで「トレイアイコン」は基本ムリなので、代表的にはこのどれかを使います：

### 選択肢A: `pystray`（トレイ常駐がシンプル）
- トレイアイコン、右クリックメニュー、クリックイベントを作りやすい
- 画像アイコンはPIL（Pillow）で作ることが多い

基本イメージ：
- `Icon(name, image, title, menu)` を作る
- `menu = Menu(Item("Toggle", on_toggle), Item("Exit", on_exit))`
- `icon.run()` で常駐開始（別スレッド運用も可）

### 選択肢B: `pywin32`（Windows API直叩き寄り）
- 通知、ショートカット、サービス寄りのことまで行けるが、トレイはやや手間
- 今回は学びはデカいけど実装コストも上がる

### 選択肢C: `tkinter` + 最小ウィンドウ + 何か（ただしトレイは別途必要）
- tkinter単体は「トレイ」に入れられないので結局補助ライブラリが必要になりがち

この課題は **A（pystray）推奨**。目的（タスクバー常駐）に最短で刺さります。

---

## 実装の設計ガイド（おすすめ構成）
- `state.py`
  - `load_state() -> bool`
  - `save_state(on: bool) -> None`
- `tray.py`
  - `create_icon(state_getter, toggle_cb, exit_cb) -> pystray.Icon`
  - 状態に応じてアイコン画像を作る（ON=緑、OFF=赤など）
- `main.py`
  - 状態の保持、トグル処理、通知処理、起動

---

## テスト観点（セルフチェック）
- 終了して再起動しても状態が復元される？
- Toggle連打しても壊れない？
- メニュー操作が固まらない？
- アイコン/ツールチップ/通知のどれかで状態が分かる？

---

## 提出物（自分用でOK）
- プロジェクト一式


---

## クリア基準
トレイに常駐して、右クリックで Toggle/Status/Exit が使えて、状態が永続化されていれば勝ち。

---